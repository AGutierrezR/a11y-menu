"use strict";var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,n,l){return n&&e(t.prototype,n),l&&e(t,l),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Navigation=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.menuId,l=void 0===n?"main-menu":n,s=t.fontFamily,o=void 0===s?"Font Awesome 5 Free":s,a=t.chevronDown,u=void 0===a?"\\f078":a,i=t.chevronUp,r=void 0===i?"\\f077":i,c=t.click,m=void 0!==c&&c;_classCallCheck(this,e),this.chevronDown=u,this.chevronUp=r,this.fontFamilies=["FontAwesome","Font Awesome 5 Free","Glyphicons Halflings"],this.fontFamily=o,this.hasNestedSubmenu=!1,this.menu=null,this.menuId=l,this.click=m}return _createClass(e,[{key:"clickHandlerOld",value:function(e){console.log(e.type,"click");var t=e.target,n=null;return"span"===t.localName&&(t=t.parentElement),document.getElementsByClassName("submenu-list-open").length>0&&!document.getElementsByClassName("submenu-list-open")[0].contains(t)?(n=document.getElementsByClassName("submenu-list-open")[0],t.nextSibling.classList.add("submenu-list-open"),t.setAttribute("aria-expanded","true"),n.classList.remove("submenu-list-open"),void n.previousSibling.setAttribute("aria-expanded","false")):((n=t.nextSibling).getElementsByTagName("ul").length?this.hasNestedSubmenu=!0:this.hasNestedSubmenu=!1,n.classList.toggle("submenu-list-open"),void(n.classList.contains("submenu-list-open")?t.setAttribute("aria-expanded","true"):t.setAttribute("aria-expanded","false")))}},{key:"focusInHandlerOld",value:function(e){var t=e.target;this.toggleMenu(t),e.preventDefault()}},{key:"keyDownHandlerOld",value:function(e){var t=e.keyCode,n=document.querySelectorAll('[aria-expanded="true"]')[0],l=document.getElementsByClassName("submenu-list-open")[0];27===t&&l&&(n.setAttribute("aria-expanded","false"),l.classList.remove("submenu-list-open"))}},{key:"mouseDownHandler",value:function(e){e.preventDefault()}},{key:"hoverHandler",value:function(e){var t=e.type,n=e.target;"mouseout"===t&&"true"===n.getAttribute("aria-haspopup")?n.setAttribute("aria-expanded","false"):"mouseover"===t&&"false"===n.getAttribute("aria-haspopup")&&n.setAttribute("aria-expanded","true")}},{key:"toggleMenuOld",value:function(e){var t=e.offsetParent.parentNode,n=this.menu.querySelectorAll('[aria-expanded="true"]'),l=this.menu.getElementsByClassName("submenu-list-open");!this.menu.contains(e)&&n.length?(n[0].setAttribute("aria-expanded","false"),l[0].classList.remove("submenu-list-open")):(n=t.querySelectorAll('[aria-expanded="true"]'),l=t.getElementsByClassName("submenu-list-open"),t.id!==this.menuId&&"ul"!==t.localName||!n.length||(n[0].setAttribute("aria-expanded","false"),l[0].classList.remove("submenu-list-open"))),console.log({target:e,expandedElementCollection:n,openElementCollection:l})}},{key:"clickHandler",value:function(e){var t=this,n=e.target,l=null;if("span"===n.localName&&(n=n.parentElement),document.querySelectorAll(".submenu-list-open").length>0&&!document.querySelectorAll(".submenu-list-open")[0].contains(n)){var s=document.querySelectorAll(".submenu-list-open");if(console.log(s,"if"),n.nextSibling&&"ul"===n.nextSibling.localName)n.nextSibling.classList.add("submenu-list-open");s.forEach(function(e){t.toggleSubmenuMenuClass(e)}),this.toggleButtonAria(n)}else null!==n.nextSibling&&(l=n.nextSibling,console.log(l,"else..."),l.getElementsByTagName("ul").length?this.hasNestedSubmenu=!0:this.hasNestedSubmenu=!1,this.toggleSubmenuMenuClass(l),this.toggleButtonAria(n))}},{key:"escapeHandler",value:function(e){var t=this,n=e.keyCode;console.log(n,"escape"),document.querySelectorAll(".submenu-list-open").forEach(function(e){t.toggleSubmenuMenuClass(e)})}},{key:"focusInHandler",value:function(e){console.log(e.target,"focus!")}},{key:"toggleButtonAria",value:function(e){var t=this;console.log(e.nextElementSibling),e.nextElementSibling.childNodes.forEach(function(e){if(e.getAttribute("data-has-children")){var n=e.querySelector("button");t.toggleButtonAria(n),console.log(n),console.log("sub-submenu found")}else console.log("nothing here....")}),console.log("expanded?",e.getAttribute("aria-expanded"),e),"false"===e.getAttribute("aria-expanded")?e.setAttribute("aria-expanded","true"):e.setAttribute("aria-expanded","false")}},{key:"toggleSubmenuMenuClass",value:function(e){null!==e?(e.classList.toggle("submenu-list-open"),console.log(e)):document.querySelectorAll(".submenu-list-open").forEach(function(e){e.classList.toggle("submenu-list-open")})}},{key:"eventDispatcher",value:function(e){switch(e.type){case"keydown":if(9===e.keyCode)this.focusInHandler(e);else if(13===e.keyCode)this.clickHandler(e);else{if(27!==e.keyCode)return;this.escapeHandler(e)}break;case"mousedown":e.preventDefault(),this.clickHandler(e);break;default:return}}},{key:"setEventListeners",value:function(){var e=this;Array.prototype.slice.call(this.menu.getElementsByClassName("no-js")).forEach(function(e){e.classList.remove("no-js")});var t=["click","focusin","keydown","mouseover"];this.click?(t.push("mousedown","mouseup"),this.menu.querySelectorAll(".submenu-list").forEach(function(e){return e.classList.add("click-menu")})):t.push("mouseout");for(var n=0;n<t.length;n++)document.addEventListener(t[n],function(t){e.eventDispatcher(t)})}},{key:"setSubmenuIcon",value:function(){var e=this,t=this.fontFamily;this.fontFamilies.includes(t)||(t="");var n=this.menu.querySelectorAll(".submenu-icon"),l="\n            nav ul li span::before {\n                content: '"+this.chevronDown+"';\n                font-family: '"+t+"';\n                font-weight: bold;\n            }\n            nav ul.click-menu li > button[aria-expanded=\"true\"] span::before,\n            nav ul:not(.click-menu) li:hover > button span::before,\n            nav ul li:focus > button span::before { \n                content: '"+this.chevronUp+"';\n                font-family: '"+t+"'; \n                font-weight: bold;\n            }",s=document.createElement("style");s.styleSheet?s.styleSheet.cssText=l:s.appendChild(document.createTextNode(l)),document.getElementsByTagName("head")[0].appendChild(s),n.forEach(function(t){return t.setAttribute("data-before",e.chevronDown)})}},{key:"init",value:function(){this.menu=document.getElementById(this.menuId),this.setEventListeners(),this.setSubmenuIcon()}}]),e}();
//# sourceMappingURL=Navigation.js.map
