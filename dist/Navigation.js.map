{"version":3,"sources":["Navigation.js"],"names":["Navigation","_ref","arguments","length","undefined","_ref$menuId","menuId","_ref$fontFamily","fontFamily","_ref$chevronDown","chevronDown","_ref$chevronUp","chevronUp","_ref$click","_classCallCheck","this","menu","click","evt","toggleMenu","target","preventDefault","fontFamilies","document","querySelectorAll","getElementsByClassName","keyCode","openSubmenu","expandedElementCollection","setAttribute","remove","type","getAttribute","submenuList","classList","contains","nextSibling","localName","add","submenuNodeList","forEach","el","_this","toggleSubmenuMenuClass","toggleButtonAria","getElementsByTagName","hasNestedSubmenu","parentElement","nextMenu","_this2","console","log","toggle","clearMenus","prevButton","previousElementSibling","button","isSameNode","clearButtons","buttonNode","clickHandler","escapeHandler","Array","prototype","slice","call","element","listeners","focusInHandler","push","i","addEventListener","_this3","eventDispatcher","_this4","icons","hoverCss","style","createElement","subMenuList","styleSheet","appendChild","createTextNode","icon","getElementById","setEventListeners","setSubmenuIcon"],"mappings":"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","file":"Navigation.js","sourcesContent":["class Navigation {\n    constructor({\n        menuId = 'main-menu',\n        fontFamily = 'Font Awesome 5 Free',\n        chevronDown = '\\\\f078',\n        chevronUp = '\\\\f077',\n        click = false\n    } = {}) {\n        this.chevronDown = chevronDown;\n        this.chevronUp = chevronUp;\n        this.fontFamilies = ['FontAwesome', 'Font Awesome 5 Free', 'Glyphicons Halflings'];\n        this.fontFamily = fontFamily;\n        this.hasNestedSubmenu = false;\n        this.menu = null;\n        this.menuId = menuId;\n        this.click = click;\n    }\n    focusInHandlerOld(evt) {\n        const { target } = evt;\n        this.toggleMenu(target);\n        evt.preventDefault();\n    }\n    keyDownHandlerOld(evt) {\n        const { keyCode } = evt;\n        const expandedElementCollection = document.querySelectorAll('[aria-expanded=\"true\"]')[0];\n        const openSubmenu = document.getElementsByClassName('submenu-list-open')[0];\n\n        if (keyCode === 27 && openSubmenu) {\n            expandedElementCollection.setAttribute('aria-expanded', 'false');\n            openSubmenu.classList.remove('submenu-list-open');\n        }\n    }\n    mouseDownHandler(evt) {\n        evt.preventDefault();\n    }\n    hoverHandler(evt) {\n        const { type, target } = evt;\n        if (type === 'mouseout' && target.getAttribute('aria-haspopup') === \"true\") {\n            target.setAttribute('aria-expanded', 'false');\n        } else if (type === 'mouseover' && target.getAttribute('aria-haspopup') === \"false\") {\n            target.setAttribute('aria-expanded', 'true');\n        }\n    }\n    clickHandler(evt) {\n        let { target } = evt;\n        let submenuList = null;\n\n        // people might click on the icon instead of the button.\n        // if so, set the target to the parent (button)\n        if (target.localName === 'span') {\n            target = target.parentElement;\n        }\n        \n        // if there's an open submenu with sub-submenus...\n        if (document.querySelectorAll('.submenu-list-open').length > 0 && !document.querySelectorAll('.submenu-list-open')[0].contains(target)) {\n            \n            const submenuNodeList = document.querySelectorAll('.submenu-list-open');\n\n            if (target.nextSibling && target.nextSibling.localName === 'ul') {\n                // if you click from one menu item to another, open the next menu and close the previous one immediately.\n                const nextMenu = target.nextSibling;\n                nextMenu.classList.add('submenu-list-open');    \n            }\n            \n            submenuNodeList.forEach((el) => {\n                // toggle all the menus in the NodeList\n                this.toggleSubmenuMenuClass(el);\n            })\n            \n            \n            this.toggleButtonAria(target);\n    \n        } else {\n            // we're near a submenu by clicking on a button but the menu isn't initially open.\n            if (target.nextSibling !== null) {\n                submenuList = target.nextSibling;\n\n                // check if there's a nested submenu\n                submenuList.getElementsByTagName('ul').length ?\n                    this.hasNestedSubmenu = true :\n                    this.hasNestedSubmenu = false;\n        \n                this.toggleSubmenuMenuClass(submenuList);\n                this.toggleButtonAria(target);\n            } \n        }\n    }\n\n    escapeHandler(evt) {\n        const { keyCode } = evt;\n        const submenuNodeList = document.querySelectorAll('.submenu-list-open');\n        // const buttonNodeList = document.querySelectorAll('[aria-expanded=\"true\"]')\n        submenuNodeList.forEach((el) => {\n            // toggle all the menus in the NodeList\n            this.toggleSubmenuMenuClass(el);\n        })\n        // buttonNodeList.forEach((el) => {\n        //     this.toggleButtonAria(el);\n        // })\n    }\n\n    focusInHandler(evt) {\n        console.log(evt.target, 'focus!')\n    }\n\n    toggleSubmenuMenuClass(el) {\n        if (el !== null) {\n            el.classList.toggle('submenu-list-open');\n            console.log(el)\n        } else {\n            this.clearMenus();\n        }\n    }\n\n    clearMenus() {\n        const menuNode = document.querySelectorAll('.submenu-list-open');\n        menuNode.forEach(menu => {\n            menu.classList.toggle('submenu-list-open');\n        })\n    }\n\n    toggleButtonAria(target) {\n        const buttonNode = document.querySelectorAll('.submenu-toggle');\n        \n        buttonNode.forEach(button => {\n            // for each button, determine if there is a button \"above\" it\n            const prevButton = button.parentElement.parentElement.previousElementSibling;\n            \n            // case - clicking on a sub-submenu button which is currently NOT expanded.\n            if (button.isSameNode(target) && button.getAttribute('aria-expanded') === 'false' && prevButton) {\n                // toggle the states of the previous button and the button/target\n                prevButton.setAttribute('aria-expanded', 'true');\n                button.setAttribute('aria-expanded', 'true');\n            }\n            // case - clicking on a sub-submenu button which is currently expanded.\n            else if (button.isSameNode(target) && button.getAttribute('aria-expanded') === 'true' && prevButton) {\n                // keep the previous button expanded and toggle the button/target\n                prevButton.setAttribute('aria-expanded', 'true');\n                button.setAttribute('aria-expanded', 'false');\n            } \n            // case - clicking on a top level button which is currently NOT expanded\n            else if (button.isSameNode(target) && button.getAttribute('aria-expanded') === 'false') {\n                // expand the button\n                button.setAttribute('aria-expanded', 'true');\n            } \n            // case - all other buttons\n            else {\n                // reset the state to false\n                button.setAttribute('aria-expanded', 'false')\n            }\n        });\n    }\n\n    clearAll() {\n        this.clearMenus();\n        this.clearButtons();\n    }\n\n    eventDispatcher(evt) {\n        // dispatch event listeners to the correct functions.\n\n        // mousedown focusin click\n        // keydown focusin keydown click\n\n        switch (evt.type) {\n            case 'keydown':\n                if (evt.keyCode === 9) {\n                    // if the keydown is caused by the tab key, it should be a focusIn\n                    this.focusInHandler(evt);\n                } else if (evt.keyCode === 13) {\n                    // if the keydown is caused by the return key, it should be a click\n                    // evt.preventDefault();\n                    this.clickHandler(evt);\n                } else if (evt.keyCode === 27) {\n                    // if the keydown is caused by the escape key, close the menus\n                    this.escapeHandler(evt);\n                } else {\n                    // throw away all other events.\n                    return;\n                }\n                break;\n            \n            case 'mousedown':\n                // if the event was caused by the mouse, don't let the target gain focus.\n                evt.preventDefault();\n                this.clickHandler(evt);\n                break;\n            \n            default:\n                return;\n        }\n    }\n    setEventListeners() {\n        // if this script is running, remove the 'no-js' class from the elements.\n        const listElements = Array.prototype.slice.call(this.menu.getElementsByClassName('no-js'));\n        listElements.forEach(element => {\n            element.classList.remove('no-js');\n        });\n        // define a list of possible event listeners\n        let listeners = ['click', 'focusin', 'keydown', 'mouseover'];\n\n        if (this.click) {\n            listeners.push('mousedown', 'mouseup');\n            \n            const subMenuList = this.menu.querySelectorAll('.submenu-list');\n            \n            subMenuList.forEach(menu => menu.classList.add('click-menu'));\n\n        } else {\n            listeners.push('mouseout');\n        }\n        // attach them to the document.\n        for (let i = 0; i < listeners.length; i++) {\n            document.addEventListener(listeners[i], (evt) => {\n                // dispatch the events to the class methods.\n                this.eventDispatcher(evt);\n            });\n        }\n    }\n    setSubmenuIcon() {\n        // possible font-family for the icons\n        let fontFamily = this.fontFamily;\n\n        if (!this.fontFamilies.includes(fontFamily)) {\n            fontFamily = '';\n        }\n\n        // the list of all the submenu icons\n        const icons = this.menu.querySelectorAll('.submenu-icon');\n        // the css to inject into the page\n        const hoverCss = `\n            nav ul li span::before {\n                content: '${this.chevronDown}';\n                font-family: '${fontFamily}';\n                font-weight: bold;\n            }\n            nav ul.click-menu li > button[aria-expanded=\"true\"] span::before,\n            nav ul:not(.click-menu) li:hover > button span::before,\n            nav ul li:focus > button span::before { \n                content: '${this.chevronUp}';\n                font-family: '${fontFamily}'; \n                font-weight: bold;\n            }`;\n\n        // create a style tag\n        const style = document.createElement('style');\n\n        // add the styles to the tag (or a stylesheet if it exists)\n        if (style.styleSheet) {\n            style.styleSheet.cssText = hoverCss;\n        } else {\n            style.appendChild(document.createTextNode(hoverCss));\n        }\n\n        // add the tag to the <head>\n        document.getElementsByTagName('head')[0].appendChild(style);\n\n        // set the data-before attribute to the values passed in the constructor.\n        icons.forEach((icon) => icon.setAttribute('data-before', this.chevronDown));\n\n        return;\n    }\n    init() {\n        this.menu = document.getElementById(this.menuId);\n        this.setEventListeners();\n        this.setSubmenuIcon();\n    }\n}\n\n"]}