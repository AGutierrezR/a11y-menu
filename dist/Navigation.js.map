{"version":3,"sources":["Navigation.js"],"names":["Navigation","_ref","arguments","length","undefined","_ref$menuId","menuId","_ref$fontFamily","fontFamily","_ref$chevronDown","chevronDown","_ref$chevronUp","chevronUp","_ref$click","_classCallCheck","this","menu","click","evt","submenuList","target","fontFamilies","parentElement","nextSibling","localName","getElementsByTagName","document","hasNestedSubmenu","classList","toggle","contains","setAttribute","getElementsByClassName","previousSibling","expandedElementCollection","querySelectorAll","openSubmenu","keyCode","remove","toggleMenu","preventDefault","type","getAttribute","openElementCollection","parentNode","id","console","log","mouseDownHandler","keyDownHandler","_this","Array","prototype","slice","call","forEach","element","listeners","clickHandler","push","add","i","hoverHandler","addEventListener","eventDispatcher","_this2","includes","icons","hoverCss","style","styleSheet","cssText","appendChild","createTextNode","icon","getElementById","setEventListeners","setSubmenuIcon"],"mappings":"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","file":"Navigation.js","sourcesContent":["class Navigation {\n    constructor({\n        menuId = 'main-menu',\n        fontFamily = 'Font Awesome 5 Free',\n        chevronDown = '\\\\f078',\n        chevronUp = '\\\\f077',\n        click = false\n    } = {}) {\n        this.chevronDown = chevronDown;\n        this.chevronUp = chevronUp;\n        this.fontFamilies = ['FontAwesome', 'Font Awesome 5 Free', 'Glyphicons Halflings'];\n        this.fontFamily = fontFamily;\n        this.hasNestedSubmenu = false;\n        this.menu = null;\n        this.menuId = menuId;\n        this.click = click;\n    }\n    clickHandler(evt) {\n        let { target } = evt;\n        let submenuList = null;\n        let activeElement = null;\n        // people might click on the icon instead of the button.\n        // if so, set the target to the parent (button)\n        if (target.localName === 'span') {\n            target = target.parentElement;\n        }\n\n        // let's open and close the menu\n\n        // if we're not clicking 'near' a submenu close any open submenus\n        if (target.nextSibling === null || target.nextSibling.localName !== 'ul') {\n\n            // if the submenu is open and we click on something else like the body\n            // close it and set aria-expanded to false\n            if (document.getElementsByClassName('submenu-list-open').length > 0) {\n\n                // there's an open submenu somewhere... we need to close it\n\n                // the submenu <ul>\n                submenuList = document.getElementsByClassName('submenu-list-open')[0];\n\n                // remove the class that displays the submenu\n                submenuList.classList.remove('submenu-list-open');\n\n                // set aria-expanded to false to switch the icon\n                submenuList.previousSibling.setAttribute('aria-expanded', 'false')\n            } else {\n                return;\n            }\n\n        } else {\n\n            // we're near a submenu by clicking on a button\n            submenuList = target.nextSibling;\n\n            // check if there's a nested submenu\n            submenuList.getElementsByTagName('ul').length \n                ? this.hasNestedSubmenu = true \n                : this.hasNestedSubmenu = false;\n\n            // toggle the submenu display class\n            submenuList.classList.toggle('submenu-list-open');\n\n            // toggle the aria-expanded attribute\n            submenuList.classList.contains('submenu-list-open') \n                ? target.setAttribute('aria-expanded', 'true') \n                : target.setAttribute('aria-expanded', 'false');\n\n            return;\n        }\n    }\n    focusInHandler(evt) {\n        const { target } = evt;\n        this.toggleMenu(target);\n    }\n    keyDownHandler(evt) {\n        const { keyCode } = evt;\n        const expandedElementCollection = document.querySelectorAll('[aria-expanded=\"true\"]')[0];\n        const openSubmenu = document.getElementsByClassName('submenu-list-open')[0];\n\n        if (keyCode === 27 && openSubmenu) {\n            expandedElementCollection.setAttribute('aria-expanded', 'false');\n            openSubmenu.classList.remove('submenu-list-open');\n        }\n    }\n    mouseDownHandler(evt) {\n        const { target } = evt;\n        this.toggleMenu(target);\n        evt.preventDefault();\n    }\n    hoverHandler(evt) {\n        const { type, target } = evt;\n        if (type === 'mouseout' && target.getAttribute('aria-haspopup') === \"true\") {\n            target.setAttribute('aria-expanded', 'false');\n        } else if (type === 'mouseover' && target.getAttribute('aria-haspopup') === \"false\") {\n            target.setAttribute('aria-expanded', 'true');\n        }\n    }\n    toggleMenu(target) {\n        \n        const { offsetParent: { parentNode } } = target;\n        let expandedElementCollection = this.menu.querySelectorAll('[aria-expanded=\"true\"]');\n        let openElementCollection = this.menu.getElementsByClassName('submenu-list-open')\n\n\n        if (!this.menu.contains(target) && expandedElementCollection.length) {\n            // if the menu doesn't contain the target, close all the submenus.\n            // this is only needed for tabbing out of open submenus into something out of the nav.\n            expandedElementCollection[0].setAttribute('aria-expanded', 'false');\n            openElementCollection[0].classList.remove('submenu-list-open')\n\n        } else {\n            // close the submenu when you leave by checking if focus has returned to the parentNode\n            expandedElementCollection = parentNode.querySelectorAll('[aria-expanded=\"true\"]');\n            openElementCollection = parentNode.getElementsByClassName('submenu-list-open');\n\n            if ((parentNode.id === this.menuId || parentNode.localName === 'ul') &&\n                expandedElementCollection.length) {\n                expandedElementCollection[0].setAttribute('aria-expanded', 'false');\n                openElementCollection[0].classList.remove('submenu-list-open');\n            }\n        }\n        console.log({ target, expandedElementCollection, openElementCollection })\n        return;\n    }\n    eventDispatcher(evt) {\n        // dispatch event listeners to the correct functions.\n        switch (evt.type) {\n            case 'click':\n                this.clickHandler(evt);\n                break;\n            case 'mousedown':\n                this.mouseDownHandler(evt);\n                break;\n            case 'focusin':\n                this.focusInHandler(evt);\n                break;\n            case 'keydown':\n                this.keyDownHandler(evt);\n                break;\n            case 'mouseover':\n            case 'mouseout':\n                this.hoverHandler(evt);\n                break;\n            default:\n                return;\n                break;\n        }\n    }\n    setEventListeners() {\n        // if this script is running, remove the 'no-js' class from the elements.\n        const listElements = Array.prototype.slice.call(this.menu.getElementsByClassName('no-js'));\n        listElements.forEach(element => {\n            element.classList.remove('no-js');\n        });\n        // define a list of possible event listeners\n        let listeners = ['focusin', 'keydown', 'mouseover'];\n\n        if (this.click) {\n            listeners.push('click', 'mousedown');\n            \n            const subMenuList = this.menu.querySelectorAll('.submenu-list');\n            \n            subMenuList.forEach(menu => menu.classList.add('click-menu'));\n\n        } else {\n            listeners.push('mouseout');\n        }\n        // attach them to the document.\n        for (let i = 0; i < listeners.length; i++) {\n            document.addEventListener(listeners[i], (evt) => {\n                // dispatch the events to the class methods.\n                this.eventDispatcher(evt);\n            });\n        }\n    }\n    setSubmenuIcon() {\n        // possible font-family for the icons\n        let fontFamily = this.fontFamily;\n\n        if (!this.fontFamilies.includes(fontFamily)) {\n            fontFamily = '';\n        }\n\n        // the list of all the submenu icons\n        const icons = this.menu.querySelectorAll('.submenu-icon');\n        // the css to inject into the page\n        const hoverCss = `\n            nav ul li span::before {\n                content: '${this.chevronDown}';\n                font-family: '${fontFamily}';\n                font-weight: bold;\n            }\n            nav ul.click-menu li > button[aria-expanded=\"true\"] span::before,\n            nav ul:not(.click-menu) li:hover > button span::before,\n            nav ul li:focus > button span::before { \n                content: '${this.chevronUp}';\n                font-family: '${fontFamily}'; \n                font-weight: bold;\n            }`;\n\n        // create a style tag\n        const style = document.createElement('style');\n\n        // add the styles to the tag (or a stylesheet if it exists)\n        if (style.styleSheet) {\n            style.styleSheet.cssText = hoverCss;\n        } else {\n            style.appendChild(document.createTextNode(hoverCss));\n        }\n\n        // add the tag to the <head>\n        document.getElementsByTagName('head')[0].appendChild(style);\n\n        // set the data-before attribute to the values passed in the constructor.\n        icons.forEach((icon) => icon.setAttribute('data-before', this.chevronDown));\n\n        return;\n    }\n    init() {\n        this.menu = document.getElementById(this.menuId);\n        this.setEventListeners();\n        this.setSubmenuIcon();\n    }\n}\n\n"]}